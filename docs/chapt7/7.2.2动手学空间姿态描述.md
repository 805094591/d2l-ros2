# 7.2.2动手学空间姿态描述与变换

大家好，我是小鱼，上一节我们学习了坐标的描述和坐标变换，本节课我们把重点放到动手实现上，通过numpy实现坐标的描述和变换，同时结合ROS2鱼RVIZ进行坐标关系可视化与求解。

通过本节你将掌握：
- 使用numpy表示位置矢量和旋转矩阵
- 使用numpy进行平移与旋转坐标变换
- 了解ROS2中TF2的概念
- 掌握tf2相关CLI工具进行坐标变换
- 掌握python操作TF进行坐标变换

1.numpy表示位姿

在前几节中，小鱼带你安装使用了ROS2和MiniConda，并学习使用Numpy进行矩阵相关运算的验证。

那我们如何使用numpy中的矩阵表示位置矢量和旋转矩阵呢？

1.1 位置表示

上一节中我们使用一个3行1列的矩阵表示了位置，那么我们在numpy中自然也可以使用这样一个矩阵表示。

打开终端，输入下面指令打开jupyter

```shell
jupyter-notebook
```

新建一个python3的代码并重命名，接着在单元格中导入numpy

```
import numpy as np
```

![image-20211105102418250](7.2.2动手学空间姿态描述/imgs/image-20211105102418250.png)

1.1.1 位置矩阵

使用3*1的矩阵表示位置，我们新建一个沿着x、y、z各平移1个单位的位置矢量。

```
np.asarray([1.0,1.0,1.0]).reshape(3,1)
```

![image-20211105102746824](7.2.2动手学空间姿态描述/imgs/image-20211105102746824.png)

1.2 姿态表示

姿态可以使用`3*3`的旋转矩阵表示,`3*3`的单位矩阵代表没有姿态变换，注意没有姿态变换不是零矩阵，而是单位矩阵。

我们新建一个旋转矩阵，用该旋转矩阵表示绕着z轴旋转45度，可以这样写：

```
import math
import numpy as np
theta = math.radians(45)
R_AB = np.asarray([math.cos(theta),-math.sin(theta),0,
                   math.sin(theta),math.cos(theta),0,
                   0,0,1
                  ]).reshape(3,3)
print(R_AB)
```

运行后得到的旋转矩阵是不是和上节的一样

![image-20211105110244694](7.2.2动手学空间姿态描述/imgs/image-20211105110244694.png)

2.numpy坐标变换

掌握了使用numpy表示位置和姿态后，接着我们来使用numpy来完成上一节的两个小练习，来动手体验一下：



3.tf2介绍
4.tf2相关工具进行坐标变换

5.python操作tf2坐标变换























--------------

技术交流&&问题求助：

- **微信公众号及交流群：鱼香ROS**
- **小鱼微信：AiIotRobot**
- **QQ交流群：139707339**
- 版权保护：已加入“维权骑士”（rightknights.com）的版权保护计划
